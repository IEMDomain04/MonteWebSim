<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Monte Carlo Simulation Table</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            text-align: center;
        }
        table {
            width: 60%;
            margin: 20px auto;
            border-collapse: collapse;
        }
        th, td {
            border: 1px solid black;
            padding: 8px;
        }
        th {
            background-color: #f2f2f2;
        }
        td[contenteditable="true"] {
            background-color: #e8f4ff;
        }
    </style>
</head>
<body>
    <h1>Monte Carlo Simulation Table</h1>
    <button class="js-add-row">Add Row</button>
    <button class="js-delete-row">Delete Row</button>
    <table id="simulationTable">
        <thead>
            <tr>
                <th>Description</th>
                <th>Number</th>
                <th>Probability</th>
                <th>Cumulative Probability</th>
                <th>Random Number Interval</th>
            </tr>
        </thead>
        <tbody></tbody>
    </table>
    
    <script>
        let cumulativeSum = 0;
        let previousEnd = 0;

        document.addEventListener("DOMContentLoaded", function () {
            const btnAdd = document.querySelector(".js-add-row");
            const btnDel = document.querySelector(".js-delete-row");
            const tableBody = document.querySelector("#simulationTable tbody");
            
            btnAdd.onclick = function () {
                const newRow = tableBody.insertRow();
                
                for (let i = 0; i < 3; i++) {
                    const cell = newRow.insertCell(i);
                    cell.contentEditable = "true";
                    cell.textContent = "Click to Edit";
                    cell.onclick = function () {
                        if (cell.textContent === "Click to Edit") {
                            cell.textContent = "";
                        }
                    };
                }
                
                const cumProbCell = newRow.insertCell(3);
                cumProbCell.textContent = "0.0";
                const rangeCell = newRow.insertCell(4);
                rangeCell.textContent = "0 to 0";
                
                const probCell = newRow.cells[2];
                probCell.addEventListener("input", function () {
                    updateTable();
                });
            };
            
            btnDel.onclick = function () {
                if (tableBody.rows.length > 0) {
                    tableBody.deleteRow(tableBody.rows.length - 1);
                    updateTable();
                }
            };
            
            function updateTable() {
                cumulativeSum = 0;
                previousEnd = 0;
                
                for (let row of tableBody.rows) {
                    const probCell = row.cells[2];
                    const cumProbCell = row.cells[3];
                    const rangeCell = row.cells[4];
                    
                    let prob = parseFloat(probCell.textContent) || 0;
                    
                    if (Number.isInteger(prob) && prob >= 0 && prob <= 100) {
                        prob /= 100;
                    } else {
                        cumProbCell.textContent = cumulativeSum.toFixed(1);
                    }
                    
                    cumulativeSum += prob;
                    cumProbCell.textContent = cumulativeSum.toFixed(1);
                    
                    const rangeStart = previousEnd;
                    const rangeEnd = (cumulativeSum * 100) - 1;
                    rangeCell.textContent = `${rangeStart.toFixed(0)} to ${rangeEnd.toFixed(0)}`;
                    
                    previousEnd = rangeEnd + 1;
                }
            }
        });
    </script>
</body>
</html>
